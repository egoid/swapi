var myapp=angular.module("myapp",["ui.router"]);myapp.run(function($rootScope){$rootScope.planets=[];$rootScope.page=1;$rootScope.base="http://swapi.co/api/planets/?page="});myapp.service("store",function($rootScope,$http,$stateParams){$rootScope.storage={};this.getData=function(){$rootScope.id=$stateParams.id;console.log($rootScope.id);$http.get("http://swapi.co/api/people/"+$rootScope.id+"/?format=json").then(resp=>{var arr=[resp.data.name,resp.data.gender,resp.data.birth_year];$rootScope.storage[$rootScope.id]=arr})}});myapp.controller("ResidentCtrl",function($scope,$rootScope,$stateParams,store){$scope.index=$rootScope.id;$scope.answer=$rootScope.storage;store.getData()});myapp.service("xxx",function($http,$rootScope){this.getPlanets=function(){var url="http://swapi.co/api/planets/?page=#&format=json".replace(/\#/,$rootScope.page);$http.get(url).then(resp=>{$rootScope.planets=resp.data.results.map(planet=>{planet.residents=planet.residents.map(resident=>{resident={url:resident};resident.id=resident.url.match(/\d+/)[0];return resident});$rootScope.planets.push(planet);return planet})}).catch(error=>console.error(error.status))}});myapp.service("xxx",function($http,$rootScope){this.getPlanets=function(){var url="http://swapi.co/api/planets/?page=#&format=json".replace(/\#/,$rootScope.page);$http.get(url).then(resp=>{$rootScope.planets=resp.data.results.map(planet=>{planet.residents=planet.residents.map(resident=>{resident={url:resident};resident.id=resident.url.match(/\d+/)[0];return resident});$rootScope.planets.push(planet);return planet})}).catch(error=>console.error(error.status))}});myapp.controller("PlanetCtrl",function($scope,$state,$rootScope,xxx){xxx.getPlanets();$scope.page=$rootScope.page;$scope.planets=$rootScope.planets;$scope.save=function(){$state.reload()};$scope.add=function(){$rootScope.page=$rootScope.page+1;$scope.save()};$scope.prev=function(){$rootScope.page=$rootScope.page-1;$scope.save()};$scope.doSomething=function(){$scope.add()};$scope.backSomething=function(){$scope.prev()}});myapp.config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/planets");$stateProvider.state("planets",{url:"/planets",templateUrl:"planets.html",controller:"PlanetCtrl"}).state("resident",{url:"/resident/:id",templateUrl:"resident.html",controller:"ResidentCtrl"})});